{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///F:/Projects/Odoo_Hackathon_Human_Resource_Management_System/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\n\nexport function getServiceSupabase() {\n  const serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY!;\n  return createClient(supabaseUrl, serviceRoleKey);\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,gMAAY,EAAC,aAAa;AAE3C,SAAS;IACd,MAAM,iBAAiB,QAAQ,GAAG,CAAC,yBAAyB;IAC5D,OAAO,IAAA,gMAAY,EAAC,aAAa;AACnC","debugId":null}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///F:/Projects/Odoo_Hackathon_Human_Resource_Management_System/src/lib/auth.ts"],"sourcesContent":["import bcrypt from 'bcryptjs';\nimport jwt from 'jsonwebtoken';\nimport { cookies } from 'next/headers';\nimport { getServiceSupabase } from './supabase';\nimport type { AuthUser, Employee } from './types';\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'dayflow-secret';\n\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, 10);\n}\n\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n  return bcrypt.compare(password, hash);\n}\n\nexport function generateToken(user: AuthUser): string {\n  return jwt.sign(user, JWT_SECRET, { expiresIn: '7d' });\n}\n\nexport function verifyToken(token: string): AuthUser | null {\n  try {\n    return jwt.verify(token, JWT_SECRET) as AuthUser;\n  } catch {\n    return null;\n  }\n}\n\nexport async function getCurrentUser(): Promise<AuthUser | null> {\n  const cookieStore = await cookies();\n  const token = cookieStore.get('auth_token')?.value;\n  if (!token) return null;\n  return verifyToken(token);\n}\n\nexport async function getEmployeeById(id: string): Promise<Employee | null> {\n  const supabase = getServiceSupabase();\n  const { data, error } = await supabase\n    .from('employees')\n    .select('*')\n    .eq('id', id)\n    .single();\n  \n  if (error) return null;\n  return data;\n}\n\nexport function generateLoginId(\n  companyCode: string,\n  firstName: string,\n  lastName: string,\n  joiningYear: number,\n  serialNumber: number\n): string {\n  const initials = (firstName.charAt(0) + lastName.substring(0, 2)).toUpperCase();\n  const serial = serialNumber.toString().padStart(4, '0');\n  return `${companyCode}${initials}${joiningYear}${serial}`;\n}\n\nexport function generateRandomPassword(): string {\n  const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789@#$%';\n  let password = '';\n  for (let i = 0; i < 12; i++) {\n    password += chars.charAt(Math.floor(Math.random() * chars.length));\n  }\n  return password;\n}\n\nexport function isAdminOrHR(role: string): boolean {\n  return role === 'admin' || role === 'hr';\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;;;;;AAGA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,eAAe,aAAa,QAAgB;IACjD,OAAO,8IAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eAAe,QAAgB,EAAE,IAAY;IACjE,OAAO,8IAAM,CAAC,OAAO,CAAC,UAAU;AAClC;AAEO,SAAS,cAAc,IAAc;IAC1C,OAAO,kJAAG,CAAC,IAAI,CAAC,MAAM,YAAY;QAAE,WAAW;IAAK;AACtD;AAEO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,eAAe;IAC7C,IAAI,CAAC,OAAO,OAAO;IACnB,OAAO,YAAY;AACrB;AAEO,eAAe,gBAAgB,EAAU;IAC9C,MAAM,WAAW,IAAA,8IAAkB;IACnC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,aACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,IACT,MAAM;IAET,IAAI,OAAO,OAAO;IAClB,OAAO;AACT;AAEO,SAAS,gBACd,WAAmB,EACnB,SAAiB,EACjB,QAAgB,EAChB,WAAmB,EACnB,YAAoB;IAEpB,MAAM,WAAW,CAAC,UAAU,MAAM,CAAC,KAAK,SAAS,SAAS,CAAC,GAAG,EAAE,EAAE,WAAW;IAC7E,MAAM,SAAS,aAAa,QAAQ,GAAG,QAAQ,CAAC,GAAG;IACnD,OAAO,GAAG,cAAc,WAAW,cAAc,QAAQ;AAC3D;AAEO,SAAS;IACd,MAAM,QAAQ;IACd,IAAI,WAAW;IACf,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,IAAK;QAC3B,YAAY,MAAM,MAAM,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,MAAM,MAAM;IAClE;IACA,OAAO;AACT;AAEO,SAAS,YAAY,IAAY;IACtC,OAAO,SAAS,WAAW,SAAS;AACtC","debugId":null}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":["file:///F:/Projects/Odoo_Hackathon_Human_Resource_Management_System/src/app/api/attendance/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { getServiceSupabase } from '@/lib/supabase';\nimport { getCurrentUser, isAdminOrHR } from '@/lib/auth';\n\nexport async function GET(request: NextRequest) {\n  const user = await getCurrentUser();\n  if (!user) {\n    return NextResponse.json({ error: 'Not authenticated' }, { status: 401 });\n  }\n\n  const supabase = getServiceSupabase();\n  const searchParams = request.nextUrl.searchParams;\n  const date = searchParams.get('date');\n  const employeeId = searchParams.get('employeeId');\n  const month = searchParams.get('month');\n  const year = searchParams.get('year');\n\n  let query = supabase.from('attendance').select('*, employee:employees(id, first_name, last_name, profile_picture, department, designation)');\n\n  if (date) {\n    query = query.eq('date', date);\n  }\n\n  if (month && year) {\n    const startDate = `${year}-${month.padStart(2, '0')}-01`;\n    const endDate = `${year}-${month.padStart(2, '0')}-31`;\n    query = query.gte('date', startDate).lte('date', endDate);\n  }\n\n  if (employeeId) {\n    query = query.eq('employee_id', employeeId);\n  } else if (!isAdminOrHR(user.role)) {\n    query = query.eq('employee_id', user.id);\n  }\n\n  query = query.order('date', { ascending: false });\n\n  const { data, error } = await query;\n\n  if (error) {\n    return NextResponse.json({ error: 'Failed to fetch attendance' }, { status: 500 });\n  }\n\n  return NextResponse.json({ attendance: data });\n}\n\nexport async function POST(request: NextRequest) {\n  const user = await getCurrentUser();\n  if (!user) {\n    return NextResponse.json({ error: 'Not authenticated' }, { status: 401 });\n  }\n\n  try {\n    const { action } = await request.json();\n    const supabase = getServiceSupabase();\n    const today = new Date().toISOString().split('T')[0];\n    const now = new Date().toISOString();\n\n    const { data: existing } = await supabase\n      .from('attendance')\n      .select('*')\n      .eq('employee_id', user.id)\n      .eq('date', today)\n      .single();\n\n    if (action === 'check_in') {\n      if (existing?.check_in) {\n        return NextResponse.json({ error: 'Already checked in today' }, { status: 400 });\n      }\n\n      if (existing) {\n        const { data, error } = await supabase\n          .from('attendance')\n          .update({ check_in: now, status: 'present', updated_at: now })\n          .eq('id', existing.id)\n          .select()\n          .single();\n\n        if (error) throw error;\n        return NextResponse.json({ attendance: data });\n      }\n\n      const { data, error } = await supabase\n        .from('attendance')\n        .insert({\n          employee_id: user.id,\n          date: today,\n          check_in: now,\n          status: 'present',\n        })\n        .select()\n        .single();\n\n      if (error) throw error;\n      return NextResponse.json({ attendance: data }, { status: 201 });\n    }\n\n    if (action === 'check_out') {\n      if (!existing?.check_in) {\n        return NextResponse.json({ error: 'Not checked in yet' }, { status: 400 });\n      }\n\n      if (existing.check_out) {\n        return NextResponse.json({ error: 'Already checked out today' }, { status: 400 });\n      }\n\n      const checkInTime = new Date(existing.check_in);\n      const checkOutTime = new Date(now);\n      const workHours = (checkOutTime.getTime() - checkInTime.getTime()) / (1000 * 60 * 60);\n      const extraHours = Math.max(0, workHours - 8);\n\n      const { data, error } = await supabase\n        .from('attendance')\n        .update({\n          check_out: now,\n          work_hours: Math.round(workHours * 100) / 100,\n          extra_hours: Math.round(extraHours * 100) / 100,\n          updated_at: now,\n        })\n        .eq('id', existing.id)\n        .select()\n        .single();\n\n      if (error) throw error;\n      return NextResponse.json({ attendance: data });\n    }\n\n    return NextResponse.json({ error: 'Invalid action' }, { status: 400 });\n  } catch {\n    return NextResponse.json({ error: 'Failed to update attendance' }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,MAAM,OAAO,MAAM,IAAA,sIAAc;IACjC,IAAI,CAAC,MAAM;QACT,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAoB,GAAG;YAAE,QAAQ;QAAI;IACzE;IAEA,MAAM,WAAW,IAAA,8IAAkB;IACnC,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;IACjD,MAAM,OAAO,aAAa,GAAG,CAAC;IAC9B,MAAM,aAAa,aAAa,GAAG,CAAC;IACpC,MAAM,QAAQ,aAAa,GAAG,CAAC;IAC/B,MAAM,OAAO,aAAa,GAAG,CAAC;IAE9B,IAAI,QAAQ,SAAS,IAAI,CAAC,cAAc,MAAM,CAAC;IAE/C,IAAI,MAAM;QACR,QAAQ,MAAM,EAAE,CAAC,QAAQ;IAC3B;IAEA,IAAI,SAAS,MAAM;QACjB,MAAM,YAAY,GAAG,KAAK,CAAC,EAAE,MAAM,QAAQ,CAAC,GAAG,KAAK,GAAG,CAAC;QACxD,MAAM,UAAU,GAAG,KAAK,CAAC,EAAE,MAAM,QAAQ,CAAC,GAAG,KAAK,GAAG,CAAC;QACtD,QAAQ,MAAM,GAAG,CAAC,QAAQ,WAAW,GAAG,CAAC,QAAQ;IACnD;IAEA,IAAI,YAAY;QACd,QAAQ,MAAM,EAAE,CAAC,eAAe;IAClC,OAAO,IAAI,CAAC,IAAA,mIAAW,EAAC,KAAK,IAAI,GAAG;QAClC,QAAQ,MAAM,EAAE,CAAC,eAAe,KAAK,EAAE;IACzC;IAEA,QAAQ,MAAM,KAAK,CAAC,QAAQ;QAAE,WAAW;IAAM;IAE/C,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;IAE9B,IAAI,OAAO;QACT,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA6B,GAAG;YAAE,QAAQ;QAAI;IAClF;IAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,YAAY;IAAK;AAC9C;AAEO,eAAe,KAAK,OAAoB;IAC7C,MAAM,OAAO,MAAM,IAAA,sIAAc;IACjC,IAAI,CAAC,MAAM;QACT,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAoB,GAAG;YAAE,QAAQ;QAAI;IACzE;IAEA,IAAI;QACF,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,QAAQ,IAAI;QACrC,MAAM,WAAW,IAAA,8IAAkB;QACnC,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;QACpD,MAAM,MAAM,IAAI,OAAO,WAAW;QAElC,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,SAC9B,IAAI,CAAC,cACL,MAAM,CAAC,KACP,EAAE,CAAC,eAAe,KAAK,EAAE,EACzB,EAAE,CAAC,QAAQ,OACX,MAAM;QAET,IAAI,WAAW,YAAY;YACzB,IAAI,UAAU,UAAU;gBACtB,OAAO,gJAAY,CAAC,IAAI,CAAC;oBAAE,OAAO;gBAA2B,GAAG;oBAAE,QAAQ;gBAAI;YAChF;YAEA,IAAI,UAAU;gBACZ,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,cACL,MAAM,CAAC;oBAAE,UAAU;oBAAK,QAAQ;oBAAW,YAAY;gBAAI,GAC3D,EAAE,CAAC,MAAM,SAAS,EAAE,EACpB,MAAM,GACN,MAAM;gBAET,IAAI,OAAO,MAAM;gBACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;oBAAE,YAAY;gBAAK;YAC9C;YAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,cACL,MAAM,CAAC;gBACN,aAAa,KAAK,EAAE;gBACpB,MAAM;gBACN,UAAU;gBACV,QAAQ;YACV,GACC,MAAM,GACN,MAAM;YAET,IAAI,OAAO,MAAM;YACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,YAAY;YAAK,GAAG;gBAAE,QAAQ;YAAI;QAC/D;QAEA,IAAI,WAAW,aAAa;YAC1B,IAAI,CAAC,UAAU,UAAU;gBACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;oBAAE,OAAO;gBAAqB,GAAG;oBAAE,QAAQ;gBAAI;YAC1E;YAEA,IAAI,SAAS,SAAS,EAAE;gBACtB,OAAO,gJAAY,CAAC,IAAI,CAAC;oBAAE,OAAO;gBAA4B,GAAG;oBAAE,QAAQ;gBAAI;YACjF;YAEA,MAAM,cAAc,IAAI,KAAK,SAAS,QAAQ;YAC9C,MAAM,eAAe,IAAI,KAAK;YAC9B,MAAM,YAAY,CAAC,aAAa,OAAO,KAAK,YAAY,OAAO,EAAE,IAAI,CAAC,OAAO,KAAK,EAAE;YACpF,MAAM,aAAa,KAAK,GAAG,CAAC,GAAG,YAAY;YAE3C,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,cACL,MAAM,CAAC;gBACN,WAAW;gBACX,YAAY,KAAK,KAAK,CAAC,YAAY,OAAO;gBAC1C,aAAa,KAAK,KAAK,CAAC,aAAa,OAAO;gBAC5C,YAAY;YACd,GACC,EAAE,CAAC,MAAM,SAAS,EAAE,EACpB,MAAM,GACN,MAAM;YAET,IAAI,OAAO,MAAM;YACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,YAAY;YAAK;QAC9C;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAiB,GAAG;YAAE,QAAQ;QAAI;IACtE,EAAE,OAAM;QACN,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA8B,GAAG;YAAE,QAAQ;QAAI;IACnF;AACF","debugId":null}}]
}