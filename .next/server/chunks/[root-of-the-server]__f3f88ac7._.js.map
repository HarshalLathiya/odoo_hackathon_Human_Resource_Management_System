{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///F:/Projects/Odoo_Hackathon_Human_Resource_Management_System/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\n\nexport function getServiceSupabase() {\n  const serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY!;\n  return createClient(supabaseUrl, serviceRoleKey);\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,gMAAY,EAAC,aAAa;AAE3C,SAAS;IACd,MAAM,iBAAiB,QAAQ,GAAG,CAAC,yBAAyB;IAC5D,OAAO,IAAA,gMAAY,EAAC,aAAa;AACnC","debugId":null}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///F:/Projects/Odoo_Hackathon_Human_Resource_Management_System/src/lib/auth.ts"],"sourcesContent":["import bcrypt from 'bcryptjs';\nimport jwt from 'jsonwebtoken';\nimport { cookies } from 'next/headers';\nimport { getServiceSupabase } from './supabase';\nimport type { AuthUser, Employee } from './types';\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'dayflow-secret';\n\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, 10);\n}\n\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n  return bcrypt.compare(password, hash);\n}\n\nexport function generateToken(user: AuthUser): string {\n  return jwt.sign(user, JWT_SECRET, { expiresIn: '7d' });\n}\n\nexport function verifyToken(token: string): AuthUser | null {\n  try {\n    return jwt.verify(token, JWT_SECRET) as AuthUser;\n  } catch {\n    return null;\n  }\n}\n\nexport async function getCurrentUser(): Promise<AuthUser | null> {\n  const cookieStore = await cookies();\n  const token = cookieStore.get('auth_token')?.value;\n  if (!token) return null;\n  return verifyToken(token);\n}\n\nexport async function getEmployeeById(id: string): Promise<Employee | null> {\n  const supabase = getServiceSupabase();\n  const { data, error } = await supabase\n    .from('employees')\n    .select('*')\n    .eq('id', id)\n    .single();\n  \n  if (error) return null;\n  return data;\n}\n\nexport function generateLoginId(\n  companyCode: string,\n  firstName: string,\n  lastName: string,\n  joiningYear: number,\n  serialNumber: number\n): string {\n  const initials = (firstName.charAt(0) + lastName.substring(0, 2)).toUpperCase();\n  const serial = serialNumber.toString().padStart(4, '0');\n  return `${companyCode}${initials}${joiningYear}${serial}`;\n}\n\nexport function generateRandomPassword(): string {\n  const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789@#$%';\n  let password = '';\n  for (let i = 0; i < 12; i++) {\n    password += chars.charAt(Math.floor(Math.random() * chars.length));\n  }\n  return password;\n}\n\nexport function isAdminOrHR(role: string): boolean {\n  return role === 'admin' || role === 'hr';\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;;;;;AAGA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,eAAe,aAAa,QAAgB;IACjD,OAAO,8IAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eAAe,QAAgB,EAAE,IAAY;IACjE,OAAO,8IAAM,CAAC,OAAO,CAAC,UAAU;AAClC;AAEO,SAAS,cAAc,IAAc;IAC1C,OAAO,kJAAG,CAAC,IAAI,CAAC,MAAM,YAAY;QAAE,WAAW;IAAK;AACtD;AAEO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,eAAe;IAC7C,IAAI,CAAC,OAAO,OAAO;IACnB,OAAO,YAAY;AACrB;AAEO,eAAe,gBAAgB,EAAU;IAC9C,MAAM,WAAW,IAAA,8IAAkB;IACnC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,aACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,IACT,MAAM;IAET,IAAI,OAAO,OAAO;IAClB,OAAO;AACT;AAEO,SAAS,gBACd,WAAmB,EACnB,SAAiB,EACjB,QAAgB,EAChB,WAAmB,EACnB,YAAoB;IAEpB,MAAM,WAAW,CAAC,UAAU,MAAM,CAAC,KAAK,SAAS,SAAS,CAAC,GAAG,EAAE,EAAE,WAAW;IAC7E,MAAM,SAAS,aAAa,QAAQ,GAAG,QAAQ,CAAC,GAAG;IACnD,OAAO,GAAG,cAAc,WAAW,cAAc,QAAQ;AAC3D;AAEO,SAAS;IACd,MAAM,QAAQ;IACd,IAAI,WAAW;IACf,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,IAAK;QAC3B,YAAY,MAAM,MAAM,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,MAAM,MAAM;IAClE;IACA,OAAO;AACT;AAEO,SAAS,YAAY,IAAY;IACtC,OAAO,SAAS,WAAW,SAAS;AACtC","debugId":null}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":["file:///F:/Projects/Odoo_Hackathon_Human_Resource_Management_System/src/app/api/employees/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { getServiceSupabase } from '@/lib/supabase';\nimport { getCurrentUser, hashPassword, generateLoginId, generateRandomPassword, isAdminOrHR } from '@/lib/auth';\n\nexport async function GET(request: NextRequest) {\n  const user = await getCurrentUser();\n  if (!user) {\n    return NextResponse.json({ error: 'Not authenticated' }, { status: 401 });\n  }\n\n  const supabase = getServiceSupabase();\n  const searchParams = request.nextUrl.searchParams;\n  const includeInactive = searchParams.get('includeInactive') === 'true';\n\n  let query = supabase\n    .from('employees')\n    .select('*')\n    .order('first_name');\n\n  if (!includeInactive) {\n    query = query.eq('is_active', true);\n  }\n\n  const { data, error } = await query;\n\n  if (error) {\n    return NextResponse.json({ error: 'Failed to fetch employees' }, { status: 500 });\n  }\n\n  return NextResponse.json({ employees: data });\n}\n\nexport async function POST(request: NextRequest) {\n  const user = await getCurrentUser();\n  if (!user || !isAdminOrHR(user.role)) {\n    return NextResponse.json({ error: 'Unauthorized' }, { status: 403 });\n  }\n\n  try {\n    const body = await request.json();\n    const { \n      email, first_name, last_name, department, designation, \n      joining_date, role = 'employee', phone, address, city, state, country, postal_code \n    } = body;\n\n    if (!email || !first_name || !last_name || !joining_date) {\n      return NextResponse.json({ error: 'Required fields missing' }, { status: 400 });\n    }\n\n    const supabase = getServiceSupabase();\n\n    const { data: settings } = await supabase\n      .from('company_settings')\n      .select('company_code')\n      .single();\n\n    const companyCode = settings?.company_code || 'DF';\n    const joiningYear = new Date(joining_date).getFullYear();\n\n    const { data: countData } = await supabase\n      .from('employees')\n      .select('id', { count: 'exact' })\n      .gte('joining_date', `${joiningYear}-01-01`)\n      .lte('joining_date', `${joiningYear}-12-31`);\n\n    const serialNumber = (countData?.length || 0) + 1;\n    const loginId = generateLoginId(companyCode, first_name, last_name, joiningYear, serialNumber);\n    const tempPassword = generateRandomPassword();\n    const passwordHash = await hashPassword(tempPassword);\n\n    const { data: newEmployee, error } = await supabase\n      .from('employees')\n      .insert({\n        login_id: loginId,\n        email,\n        password_hash: passwordHash,\n        first_name,\n        last_name,\n        role,\n        department,\n        designation,\n        joining_date,\n        phone,\n        address,\n        city,\n        state,\n        country,\n        postal_code,\n        must_change_password: true,\n        is_active: true,\n      })\n      .select()\n      .single();\n\n    if (error) {\n      return NextResponse.json({ error: error.message }, { status: 500 });\n    }\n\n    const { data: leaveTypes } = await supabase.from('leave_types').select('*');\n    \n    if (leaveTypes) {\n      const currentYear = new Date().getFullYear();\n      const leaveBalances = leaveTypes.map(lt => ({\n        employee_id: newEmployee.id,\n        leave_type_id: lt.id,\n        year: currentYear,\n        total_days: lt.max_days_per_year,\n        used_days: 0,\n      }));\n      \n      await supabase.from('leave_balances').insert(leaveBalances);\n    }\n\n    return NextResponse.json({ \n      employee: newEmployee, \n      credentials: { loginId, tempPassword } \n    }, { status: 201 });\n  } catch {\n    return NextResponse.json({ error: 'Failed to create employee' }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}