{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///F:/Projects/Odoo_Hackathon_Human_Resource_Management_System/src/components/providers/AuthProvider.tsx"],"sourcesContent":["'use client';\n\nimport { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport type { AuthUser } from '@/lib/types';\n\ninterface AuthContextType {\n  user: AuthUser | null;\n  loading: boolean;\n  login: (loginId: string, password: string) => Promise<{ success: boolean; error?: string; mustChangePassword?: boolean }>;\n  logout: () => Promise<void>;\n  refreshUser: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<AuthUser | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  const refreshUser = async () => {\n    try {\n      const res = await fetch('/api/auth/me');\n      if (res.ok) {\n        const data = await res.json();\n        setUser(data.user);\n      } else {\n        setUser(null);\n      }\n    } catch {\n      setUser(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    refreshUser();\n  }, []);\n\n  const login = async (loginId: string, password: string) => {\n    try {\n      const res = await fetch('/api/auth/login', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ loginId, password }),\n      });\n      const data = await res.json();\n      \n      if (res.ok) {\n        setUser(data.user);\n        return { success: true, mustChangePassword: data.user.must_change_password };\n      }\n      return { success: false, error: data.error };\n    } catch {\n      return { success: false, error: 'Login failed' };\n    }\n  };\n\n  const logout = async () => {\n    await fetch('/api/auth/logout', { method: 'POST' });\n    setUser(null);\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, loading, login, logout, refreshUser }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) throw new Error('useAuth must be used within AuthProvider');\n  return context;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;;;AAFA;;AAaA,MAAM,4BAAc,IAAA,8KAAa,EAA8B;AAExD,SAAS,aAAa,KAAqC;QAArC,EAAE,QAAQ,EAA2B,GAArC;;IAC3B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAkB;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,MAAM,cAAc;QAClB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM;YACxB,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,QAAQ,KAAK,IAAI;YACnB,OAAO;gBACL,QAAQ;YACV;QACF,EAAE,UAAM;YACN,QAAQ;QACV,SAAU;YACR,WAAW;QACb;IACF;IAEA,IAAA,0KAAS;kCAAC;YACR;QACF;iCAAG,EAAE;IAEL,MAAM,QAAQ,OAAO,SAAiB;QACpC,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,mBAAmB;gBACzC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAS;gBAAS;YAC3C;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAE3B,IAAI,IAAI,EAAE,EAAE;gBACV,QAAQ,KAAK,IAAI;gBACjB,OAAO;oBAAE,SAAS;oBAAM,oBAAoB,KAAK,IAAI,CAAC,oBAAoB;gBAAC;YAC7E;YACA,OAAO;gBAAE,SAAS;gBAAO,OAAO,KAAK,KAAK;YAAC;QAC7C,EAAE,UAAM;YACN,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAe;QACjD;IACF;IAEA,MAAM,SAAS;QACb,MAAM,MAAM,oBAAoB;YAAE,QAAQ;QAAO;QACjD,QAAQ;IACV;IAEA,qBACE,6LAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAS;YAAO;YAAQ;QAAY;kBACtE;;;;;;AAGP;GArDgB;KAAA;AAuDT,SAAS;;IACd,MAAM,UAAU,IAAA,2KAAU,EAAC;IAC3B,IAAI,CAAC,SAAS,MAAM,IAAI,MAAM;IAC9B,OAAO;AACT;IAJgB","debugId":null}}]
}